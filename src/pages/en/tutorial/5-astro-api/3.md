---
layout: ~/layouts/TutorialLayout.astro
title: Building a tag index page
setup: |
  import Checklist from '~/components/Checklist.astro';
  import Goals from '~/components/tutorial/Goals.astro';
  import MultipleChoice from '~/components/tutorial/MultipleChoice.astro';
  import Option from '~/components/tutorial/Option.astro';
---

Now that you have an individual page for every tag, let's make a Tag Index page.

<Goals>
  - created a new page using the `/tags/index.astro` routing feature 
  - displayed a list of all tags, linking to each tag page 
  - updated your site with navigation links to this new Tags page
</Goals>

## Page routes using `/folder/index.astro`

You already know that you can add a static page to your website by creating a new file at `src/pages/tags.astro`. But, since you already have the directory `/tags/`, you can take advantage of another routing pattern in Astro, and keep all your files related to tags together.

1. Create a new file `index.astro` in the directory `src/pages/tags/`.

2. Navigate to `localhost:3000/tags` and verify that your site now contains a page at this URL. It will be empty, but it will exist.

3. Try to create a minimal page at `src/pages/tags/index.astro` yourself, using patterns you have used before.

    <details>
      <summary>Expand to see the steps</summary>

      1. Create a new page component in `src/components/`.

          <details>
          <summary>Show the filename</summary>
          ```
          index.astro
          ```
          </details>

      2. Import and use your `<BaseLayout>`.

          <details>
          <summary>Show the code</summary>
          ```astro title=" src/components/tags.astro"
          ---
          import BaseLayout from '../../layouts/BaseLayout.astro';
          ---
          <BaseLayout></BaseLayout>
          ```
          </details>

      3. Define a page title, and pass it to your layout as a component attribute.

          <details>
          <summary>Show the code</summary>
          ```astro title="src/components/tags.astro" ins={3} "title={title}"
          ---
          import BaseLayout from '../../layouts/BaseLayout.astro';
          const title = "Tag Index"
          ---
          <BaseLayout title={title}></BaseLayout>
          ```
          </details>
    </details>

4. Check your browser preview again and you should have a styled page, ready to add content to!


## Create an array of tags

You have previously [displayed items in a list from an array using `map()`](/en/tutorial/2-astro-pages/3/#generating-multiple-html-elements-with-map). Can you image what it would look like to define an array of all your tags, then display them in a list on this page?

<details>
    <summary>See the code</summary>
    
    ```astro title="src/pages/tags/index.astro"
    ---
    import BaseLayout from '../../layouts/BaseLayout.astro';
    const tags = ["astro","sucesses", "community", "setbacks", "learning in Public"]
    let title = 'Tag Index'
    ---
    <BaseLayout title={title}>
      <ul>
        {tags.map((tag) => <li>{tag}</li>)}
      </ul>
    </BaseLayout>
    ```
</details>

You could do this, but then you would need to come back to this file and update your array every time you use a new tag in a future blog post.

Fortunately, you already know a way to grab the data from all your Markdown files in one line of code.

1. In `src/pages/tags/index.astro`, add the line of code to the frontmatter script that will give your page access to the data from every `.md` blog post file.

    <details>
    <summary>See the code</summary>
    ```astro title = "src/pages/tags/index.astro" ins={3}
    ---
    import BaseLayout from '../../layouts/BaseLayout.astro';
    const allPosts = await Astro.glob('../posts/*.md');
    let title = 'Tag Index'
    ---
    ```
    </details>

2. Next, add the following line of JavaScript to your page component. This uses `allPosts`, returned by `Astro.glob()`, to create an array of all the tags it finds:

    ```js
    // src/pages/tags/index.astro
    const tags = [...new Set(allPosts.map((post) => post.frontmatter.tags).flat())];
    ```

    <details>
    <summary>Tell me what this line of code is doing in more detail!</summary>

    It's OK if this isn't something you would have written yourself yet! 

    It does something similar to what you did in the last section to get a list of tags without any duplication.

    It goes through each Markdown post, one-by-one, and combines each array of tags into one single larger array. Then, it makes a new `Set` from all the individual tags it found (to ignore repeated values). Finally, it turns that set into an array (with no duplications), that you can use to show a list of tags on your page.
    </details>

## Create your list of tags

Instead of creating items in an unordered list this time, create one `<p>` for each item, inside a `<div>`. The pattern should look familiar!

1. Add the following code to your component template:

    ```astro title="src/pages/tags/index.astro" ins={2}
      <BaseLayout title={title}>
        <div>{tags.map((tag) => <p>{tag}</p>)}</div>
      </BaseLayout>
    ```
  In your browser preview, verify that you can see your tags listed.

2. To make each tag link to its own page, add the following `<a>` link to each tag name:

    ```astro title="src/pages/tags/index.astro" '/tags/${tag}'
      <BaseLayout title={title}>
       <div>
         {tags.map((tag) => (
           <p><a href={`/tags/${tag}`}>{tag}</a></p>
          ))}
        </div>
      </BaseLayout>
    ```

## Adding Styles

1. Add the following CSS classes to style both your `<div>` and each `<p>` that will be generated. Note: Astro uses HTML syntax for adding class names!

    ```astro title="src/pages/tags/index.astro" 'class="tags"'
    <div class="tags">
    ```

    ```astro title="src/pages/tags/index.astro" 'class="tag"'
    <p class="tag">
    ```

2. Define these new CSS classes by adding the following `<style>` tag inside your `<BaseLayout>`:

    ```astro title="src/pages/tags/index.astro"
    <style>
      a {
        color: #00539F;
      }
            
      .tags {
        display: flex; 
        flex-wrap: wrap; 
        margin: 0 auto;  
      }

      .tag {
        margin: 0.25em;
        border: dotted 1px #a1a1a1;
        border-radius: .5em;
        padding: .5em 1em;
        font-size: 1.15em;
        background-color: #F8FCFD;
      }
    </style>
    ```

3. Check your browser preview at `localhost:3000/tags` to verify that you have some new styles, and that each of the tags on the page has a working link to its own individual tag page.

## Code Check-In

To check your work, or if you just want complete, correct code to copy into `src/pages/tags/index.astro`, here is what your Astro component should look like:

```astro title="src/pages/tags/index.astro"
--- 
import BaseLayout from '../../layouts/BaseLayout.astro';
const allPosts = await Astro.glob('../posts/*.md');
const tags = [...new Set(allPosts.map((post) => post.frontmatter.tags).flat())];
let title = 'Tag Index';
---
<BaseLayout title={title}>
  <style>
    a {
      color: #00539F;
    }

    .tags {
      display: flex; 
      flex-wrap: wrap; 
      margin: 0 auto;  
    }

    .tag {
      margin: 0.25em;
      border: dotted 1px #a1a1a1;
      border-radius: .5em;
      padding: .5em 1em;
      font-size: 1.15em;
      background-color: #F8FCFD;
    }
   </style>

   <div class="tags">
      {tags.sort().map((tag) => (
        <p class="tag"><a href={`/tags/${tag}`}>{tag}</a></p>
      ))}
    </div>
</BaseLayout>
```

## Add this page to your navigation

Right now, you can navigate to `localhost:3000/tags` and see this page. From this page, you can click on links to your individual tag pages.

But, you still need to make these pages discoverable from other pages on your website.

1. In your `Navigation.astro` component, include a link to this new tag index page.

    <details>
    <summary>Show me the code</summary>
    ```astro title="src/components/Navigation.astro" ins={4}
    <a href="/">Home</a>
    <a href="/about/">About</a>
    <a href="/blog/">Blog</a>
    <a href="/tags/">Tags</a>
    ```
    </details>

## Challenge: Include tags in your blog post layout

You have now written all the code you need to also display a list of tags on each blog post, and link them to their tag pages. You have existing work that you can reuse!

Follow the steps below, then check your work by comparing it to the [final code sample](#final-markdownpostlayout-code-sample).

1. Copy the following two items from `src/pages/tags/index.astro` and reuse them inside `MarkdownLayoutPost.astro`: 

- `<style>`...`</style>`goes inside your `<BaseLayout>` component.

- `<div class="tags">`... `</div>` goes just above the `<slot />`.

Before this code will work, you need to make **one small edit** to the code you pasted into `MarkdownPost.astro`. Can you figure out what it is?

<details>
<summary>Give me a hint</summary>

How are the other props (e.g. title, author etc.) written in your layout template? How does your layout receive props from an individual blog post?
</details>

<details>
<summary>Give me another hint!</summary>

In order to use props (values passed) from a `.md` blog post in your layout, like tags, you need to prefix the value with a certain word.

<details>
<summary>Show me the code!</summary>

```astro title="src/layouts/MarkdownPostLayout.astro" "frontmatter"
    {frontmatter.tags.map((tag) => (
        <p class="tag"><a href={`/tags/${tag}`}>{tag}</a></p>
    ))}
```
</details>
</details>

## Final MarkdownPostLayout code sample

To check your work, or if you just want complete, correct code to copy into `MarkdownPostLayout.astro`, here is what your Astro component should look like:

```astro title="src/layouts/MarkdownPostLayout.astro" ins={6-25, 35-39}
---
import BaseLayout from './BaseLayout.astro';
const { frontmatter } = Astro.props;
--- 
<BaseLayout title={frontmatter.title}>
  <style>
    a {
      color: #00539F;
    }

    .tags {
      display: flex; 
      flex-wrap: wrap; 
      margin: 0 auto;  
    }

    .tag {
      padding: .5em 1em; 
      margin: 0.25em; 
      font-size: 1.15em; 
      background-color:#F8FCFD; 
      border: dotted 1px #a1a1a1; 
      border-radius: .5em;
    }    
  </style>

  <p><em>{frontmatter.description}</em></p>
  <p>{frontmatter.pubDate.slice(0,10)}</p>
  <h1>{frontmatter.title}</h1>

  <p>Written by: {frontmatter.author}</p>

  <img src={frontmatter.postImage} width="300" /> 

  <div class="tags">
    {frontmatter.tags.map((tag) => (
      <p class="tag"><a href={`/tags/${tag}`}>{tag}</a></p>
    ))}
  </div>

  <slot />
</BaseLayout>

```

## Before you go

### Test your knowledge

Match each file path with a second file path that will create a page at the same route.

1. `src/pages/categories.astro`

    <MultipleChoice>
      <Option>`src/pages/posts/post.astro`</Option>
      <Option>`src/pages/posts/index.astro`</Option>
      <Option>`src/components/shoes/Shoe.astro`</Option>
      <Option isCorrect>`src/pages/categories/index.astro`</Option>
    </MultipleChoice>

2. `src/pages/posts.astro`

    <MultipleChoice>
      <Option>`src/pages/products/shoes.astro`</Option>
      <Option>`src/pages/posts/post.astro`</Option>
      <Option isCorrect>`src/pages/posts/index.astro`</Option>
      <Option>`src/pages/categories/index.astro`</Option>
    </MultipleChoice>

3. `src/pages/products/shoes/index.astro`

    <MultipleChoice>
      <Option isCorrect>`src/pages/products/shoes.astro`</Option>
      <Option>`src/pages/posts/post.astro`</Option>
      <Option>`src/pages/posts/index.astro`</Option>
      <Option>`src/components/shoes/Shoe.astro`</Option>
    </MultipleChoice>

### Checklist for moving on

<Checklist key="tags">
- [ ] I can use Astro's `/pages/folder/index.astro` routing feature to create a static page.
- [ ] I can integrate a new page into my Astro site, using features I have previously built, including:

  - adding a layout and styles to my page 

  - using data from all my `.md` files

  - rendering HTML dynamically from values and `props` defined in my component script

  - updating my site navigation to include this new page
</Checklist>

### Resources

- [Static Routing in Astro](/en/core-concepts/routing/#static-routes)
